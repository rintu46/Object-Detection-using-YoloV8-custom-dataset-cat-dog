# -*- coding: utf-8 -*-
"""cat_dog.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1EGthutPkXr6iatCb3T4IM8xxRLCIKkOj
"""

# Pip install method (recommended)

!pip install ultralytics==8.0.20

from IPython import display
display.clear_output()

import ultralytics
ultralytics.checks()

# import yolo
from ultralytics import YOLO

from IPython.display import display, Image

from google.colab import drive
drive.mount('/content/drive')

# Commented out IPython magic to ensure Python compatibility.
# %cd /content/drive/MyDrive/Colab Notebooks/v8

!ls

# Commented out IPython magic to ensure Python compatibility.
# train the model using the training folder data
# %cd /content/drive/MyDrive/Colab Notebooks/v8

!yolo task=detect mode=train model=yolov8s.pt data= data.yaml epochs=50 imgsz=250 plots=True

!ls

# just check what type of files we get after successful training  
!ls runs/detect/train7/

# confusion matrix
Image(filename='runs/detect/train7/confusion_matrix.png', width=600)

# other matrics results like recall, precision, avg precision and so on
Image(filename='runs/detect/train7/results.png', width=600)

# visualize some trained image output
Image(filename='runs/detect/train7/val_batch0_pred.jpg', width=600)

# for validation
!yolo task=detect mode=val model=runs/detect/train7/weights/best.pt data=data.yaml

# run the model for prediction on our test data
!yolo task=detect mode=predict model=runs/detect/train7/weights/best.pt conf=0.25 source=data/test/images

# visualize some validation output

import glob
from IPython.display import Image, display

for image_path in glob.glob('runs/detect/val4/*.jpg')[:3]:
      display(Image(filename=image_path, width=600))
      print("\n")

# !yolo task=detect mode=predict model=runs/detect/train6/weights/best.pt conf=0.25 source=data/test/images



"""# **Let's try some unseen data**"""



model = YOLO('/content/drive/MyDrive/Colab Notebooks/v8/runs/detect/train7/weights/best.pt')

from ultralytics import YOLO
from PIL import Image
import cv2

# from PIL
img = Image.open("/content/c5.jpg")
results = model.predict(source=img, save=True)
# print(results)
display(Image.open('runs/detect/predict4/image0.jpg'))

